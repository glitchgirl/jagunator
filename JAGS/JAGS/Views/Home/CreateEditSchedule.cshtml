@model CourseInfo
@{
    ViewData["Title"] = "Create/Edit Schedule";
    if (ViewBag.sessiontype == "Admin")
    {
    Layout = "_Layout";
    }
    else if (ViewBag.sessiontype == "Editor")
    {
    Layout = "_LayoutEditor";
    }
    else if (ViewBag.sessiontype == "Viewer")
    {
    Layout = "_LayoutViewer";
    }
}

@using Microsoft.AspNetCore.Mvc;
@using Microsoft.AspNetCore.Http;
@using System.Linq;
@using System.Collections.Generic;


<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>

@*<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>*@
<script src="~/js/moment.min.js"></script>
<script src="~/js/fullcalendar.js"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.8.2/fullcalendar.min.css">
<link rel="stylesheet" href="https://code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">

<h2>Create Edit Schedule</h2>
<div id='wrap'>
    <div class="form-inline">
    <div class="SemesterAndLabel">
    <label for="Semester">Semester</label>
        <div class="text-center" id="Semester">
            @Html.DropDownListFor(a => a.Semester, new SelectList(Model.Semester, "SemesterID","SemesterNameFromDirectory"), "Select Semester", new {@class="form-control"})
        </div>
         <!--TODO: Add dropdown for subject-->     
                <div id='wrap'>
        <div id='external-events'>
            <div id='external-events-listing'>
                <h4>Courses</h4>
                <div class='fc-event'>My Event 1</div>
                <div class='fc-event'>My Event 2</div>
                <div class='fc-event'>My Event 3</div>
                <div class='fc-event'>My Event 4</div>
                <div class='fc-event'>My Event 5</div>
            </div>
            <p>
                <input type='checkbox' id='drop-remove'  checked='checked'/>
                <label for='drop-remove'>remove after drop</label>
            </p>
        </div>

        <div id='calendar'></div>

        <div style='clear:both'></div>

    </div>
        <br>
    <div class="scheduleButtons">
        <input type="button" value="Clear"><br>
        <input type="button" value="Export schedule"><br>
    </div>
 <div class="scheduleErrors">
        Conflicts 
    </div>

@*<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>*@
<script type="text/javascript">
 $(function()
 {
      $("#Semester").change(function() 
        {
                alert("it works");
                var u = $("#Semester option:selected").text()             
                $.post("@Url.Action("GetSectionValues", "Home")?val=" + u, function(res) 
                {
                    var JSsections = '@ViewBag.sections'
                    if (res.success === "true") 
                    {
                        alert(res.data);
                        @*$("#").val(u);*@
                        var newDiv = document.createElement("div"); 
                        // and give it some content 
                        var newContent = document.createTextNode("Hi there and greetings!"); 
                        // add the text node to the newly created div
                        newDiv.appendChild(newContent);  

                        // add the newly created element and its content into the DOM 
                        var currentDiv = document.getElementById("external-events-listing"); 
                        document.body.appendChild(newDiv, currentDiv);

                        blockDiv = document.createElement("div");
                        blockDiv.className = "external-events";
                        textSpan = document.createElement("span");
                        textSpan.append("this is a test");  // see note about browser compatibility
                        blockDiv.append(textSpan);
                        blockDiv.innerHTML = "Test InnerHTML"
                        innerdiv = document.createElement("div");
                        innerdiv.className = "fc-event";
                        innerdiv.innerHTML = "innerdiv test";
                        blockDiv.append(innerdiv);
                        //document.body.appendChild(blockDiv);
                        var externalevents = document.getElementById('external-events-listing')
                        externalevents.appendChild(innerdiv);

                        $('#external-events .fc-event').each(function() {

                        // store data so the calendar knows to render an event upon drop
                        $(this).data('event', {
                            title: $.trim($(this).text()), // use the element's text as the event title
                            stick: true // maintain when user navigates (see docs on the renderEvent method)
                            });

                        // make the event draggable using jQuery UI
                        $(this).draggable({
                        zIndex: 999,
                        revert: true,      // will cause the event to go back to its
                        revertDuration: 0  //  original position after the drag
                            });

                        });
                    } 
                    else 
                    {
                        alert("Error getting data!");
                    }
                });
        });
 });
</script>
<script src="~/js/site.js"></script>